# ========================
# 플러그인 설정
# ========================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'rose-pine/tmux'
set -g @plugin 'tmux-plugins/tmux-resurrect'

# Rose Pine 테마 설정
set -g @rose_pine_variant 'moon'  # 'main', 'moon', 'dawn' 중 선택

# ========================
# 기본 설정
# ========================
set -g default-terminal "xterm-256color"
set-option -ga terminal-overrides ",xterm-256color:Tc"
set -g history-limit 10000
set -g base-index 1
set -s escape-time 1
set-option -g default-shell /bin/zsh

setw -g pane-base-index 1
setw -g mode-keys vi

# ========================
# 키 바인딩
# ========================

# --- Pane 이동 (copy-mode에서) --
bind-key n select-pane -L # 아래 pane	
bind-key e select-pane -R  # 아래 pane
# --- Copy-mode 기능 ---
# copy-mode에서 'a' 누르면 선택한 경로로 nvim 실행
bind-key -T copy-mode-vi a send-keys -X copy-pipe-and-cancel \
  'cd #{pane_current_path}; xargs tmux new-window nvim'

# ========================
# 추가 기능
# ========================

# 메뉴 네비게이션 팝업 (Alt+o)
bind -n M-o display-popup -w 90% -h 90% -E "crush"

# 파일 경로 검색 (Alt+r)
bind -n M-r copy-mode -e \; send-keys -X search-backward \
  '(^|/|\<|[[:space:]"])((\.|\.\.)|[[:alnum:]~_"-]*)((/[][[:alnum:]_.#$%&+=@"-]+)+([/ "]|\.([][[:alnum:]_.#$%&+=@"-]+(:[0-9]+)?(:[0-9]+)?)|[][[:alnum:]_.#$%&+=@"-]+(:[0-9]+)(:[0-9]+)?)|(/[][[:alnum:]_.#$%&+=@"-]+){2,}([/ "]|\.([][[:alnum:]_.#$%&+=@"-]+(:[0-9]+)?(:[0-9]+)?)|[][[:alnum:]_.#$%&+=@"-]+(:[0-9]+)(:[0-9]+)?)?|(\.|\.\.)/([][[:alnum:]_.#$%&+=@"-]+(:[0-9]+)?(:[0-9]+)?))'

# ========================
# 플러그인 매니저 실행
# ========================
run '~/.config/tmux/plugins/tpm/tpm'
